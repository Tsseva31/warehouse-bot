═══════════════════════════════════════════════════════════
WAREHOUSE BOT v1.2 - ТЕХНИЧЕСКОЕ ОПИСАНИЕ
═══════════════════════════════════════════════════════════

📋 НАЗНАЧЕНИЕ
Telegram-бот для складского учёта компании Imagine Pilai (Таиланд).
Быстрая регистрация приёмки/выдачи товаров с фото.
Билингвальный интерфейс: русский + тайский.

═══════════════════════════════════════════════════════════
🆕 ИЗМЕНЕНИЯ v1.2
═══════════════════════════════════════════════════════════

✅ РЕАЛИЗОВАНО:

1. UX - автостарт:
   ✅ При любом сообщении без активного состояния → главное меню
   ✅ Автоочистка временных файлов при старте
   ✅ Нет "застрявших" состояний

2. Помощь:
   ✅ Кнопка "❓ Помощь / ช่วยเหลือ" в главном меню
   ✅ Текстовая инструкция по всем функциям
   ✅ Опциональная отправка PDF (если есть файл docs/instruction.pdf)

3. Подсказки по фото:
   ✅ Показываются ОДИН раз при входе в режим фото (первая позиция)
   ✅ Компактные инструкции: этикетка, штрих-код, общий вид
   ✅ Отдельные инструкции для фото машин

4. Клавиатура количества:
   ✅ Упрощённый numpad: [1][2][3] / [4][5][6] / [7][8][9] / [10][0][100]
   ✅ Кнопка [✏️ Ввести число / ใส่ตัวเลข]
   ✅ Прямой ввод числа текстом (например, "345" → принимает 345)

5. Комментарии:
   ✅ Убран комментарий после каждой позиции
   ✅ Только ОДИН итоговый комментарий в конце операции

6. Форматирование таблиц:
   ✅ Google Apps Script в format_sheets.txt
   ✅ Группировка операций по Operation_ID
   ✅ Меню "🔧 Склад" → "📊 Форматировать"

═══════════════════════════════════════════════════════════
🏗️ АРХИТЕКТУРА
═══════════════════════════════════════════════════════════

📁 Структура файлов:
├── bot.py                 # Главный файл, Telegram handlers
├── config.py              # Конфигурация из .env
├── services/
│   ├── __init__.py
│   ├── sheets_handler.py  # Работа с Google Sheets
│   ├── drive_handler.py   # Загрузка фото в Google Drive
│   └── permissions.py     # Права пользователей
├── utils/
│   ├── __init__.py
│   └── localization.py    # Тексты RU/TH
├── docs/
│   └── instruction.pdf    # Инструкция (опционально)
├── setup_tables.py        # Настройка таблиц
├── format_sheets.txt      # Google Apps Script
└── .env                   # Секреты

═══════════════════════════════════════════════════════════
📊 FLOW ПРИЁМКИ/ВЫДАЧИ (v1.2)
═══════════════════════════════════════════════════════════

1. Выбор операции (Приёмка/Выдача)
2. Выбор контрагента/места
3. Цикл позиций:
   a. Фото (1-5, инструкции только для первой позиции)
   b. Количество (numpad или ввод)
   c. [➕ Ещё позиция] или [✅ Завершить]
4. Итоговый комментарий (опционально)
5. Сохранение

═══════════════════════════════════════════════════════════
⚙️ УСТАНОВКА
═══════════════════════════════════════════════════════════

1. Скопировать файлы
2. Создать .env с настройками:
   - TELEGRAM_BOT_TOKEN
   - GOOGLE_SERVICE_ACCOUNT_FILE
   - WAREHOUSE_MAIN_SHEET_ID
   - и другие ID таблиц/папок

3. Установить зависимости:
   pip install python-telegram-bot google-api-python-client google-auth python-dotenv gspread

4. Запустить настройку таблиц:
   python setup_tables.py

5. Добавить Google Apps Script в таблицу Движения:
   - Открыть таблицу
   - Расширения → Apps Script
   - Вставить код из format_sheets.txt
   - Сохранить

6. Запустить бота:
   python bot.py

═══════════════════════════════════════════════════════════
📋 ЗАДАЧИ v1.3+ (после стабилизации)
═══════════════════════════════════════════════════════════

□ Голосовой ввод комментариев (voice-to-text)
□ Расширенная история с фильтрами
□ Уведомления админу
□ Отчёты за день/неделю
□ Деплой на сервер (24/7 работа)

═══════════════════════════════════════════════════════════
